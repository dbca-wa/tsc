(function(e,t,a){L.TileLayer.Ajax=L.TileLayer.extend({_requests:[],_addTile:function(e){var t={datum:null,processed:!1};this._tiles[e.x+":"+e.y]=t,this._loadTile(t,e)},_xhrHandler:function(e,t,a,i){return function(){if(4===e.readyState){var s=e.status;s>=200&&300>s||304===s?(a.datum=JSON.parse(e.responseText),t._tileLoaded(a,i)):t._tileLoaded(a,i)}}},_loadTile:function(e,t){this._adjustTilePoint(t);var a=this,i=new XMLHttpRequest;this._requests.push(i),i.onreadystatechange=this._xhrHandler(i,a,e,t),i.open("GET",this.getTileUrl(t),!0),i.send()},_reset:function(){L.TileLayer.prototype._reset.apply(this,arguments);for(var e=0;e<this._requests.length;e++)this._requests[e].abort();this._requests=[]},_update:function(){this._map&&this._map._panTransition&&this._map._panTransition._inProgress||(this._tilesToLoad<0&&(this._tilesToLoad=0),L.TileLayer.prototype._update.apply(this,arguments))}}),L.TileLayer.GeoJSON=L.TileLayer.Ajax.extend({_keyLayers:{},_clipPathRectangles:{},initialize:function(e,t,a){L.TileLayer.Ajax.prototype.initialize.call(this,e,t),this.geojsonLayer=new L.GeoJSON(null,a)},onAdd:function(e){this._map=e,L.TileLayer.Ajax.prototype.onAdd.call(this,e),e.addLayer(this.geojsonLayer)},onRemove:function(e){e.removeLayer(this.geojsonLayer),L.TileLayer.Ajax.prototype.onRemove.call(this,e)},_reset:function(){this.geojsonLayer.clearLayers(),this._keyLayers={},this._removeOldClipPaths(),L.TileLayer.Ajax.prototype._reset.apply(this,arguments)},_removeOldClipPaths:function(){for(var e in this._clipPathRectangles){var a=e.split("_").slice(1),i=parseInt(a[0],10);if(i!==this._map.getZoom()){var s=this._clipPathRectangles[e];this._map.removeLayer(s);var r=t.getElementById(e);null!==r&&r.parentNode.removeChild(r),delete this._clipPathRectangles[e]}}},_recurseLayerUntilPath:function(e,t){t instanceof L.Path?e(t):t instanceof L.LayerGroup&&t.getLayers().forEach(this._recurseLayerUntilPath.bind(this,e),this)},_clipLayerToTileBoundary:function(e,a){if(L.Path.SVG&&this._map){this._map._pathRoot||(this._map._pathRoot=L.Path.prototype._createElement("svg"),this._map._panes.overlayPane.appendChild(this._map._pathRoot));var i=this._map._pathRoot,s=null;0===i.getElementsByTagName("defs").length?(s=t.createElementNS(L.Path.SVG_NS,"defs"),i.insertBefore(s,i.firstChild)):s=i.getElementsByTagName("defs")[0];var r="tileClipPath_"+a.z+"_"+a.x+"_"+a.y,o=t.getElementById(r);if(null===o){o=t.createElementNS(L.Path.SVG_NS,"clipPath"),o.id=r;var n=this.options.tileSize,l=a.multiplyBy(n),h=l.add([n,n]),p=this._map.unproject(l),y=this._map.unproject(h);this._clipPathRectangles[r]=new L.Rectangle(new L.LatLngBounds([p,y]),{opacity:0,fillOpacity:0,clickable:!1,noClip:!0}),this._map.addLayer(this._clipPathRectangles[r]);var u=t.createElementNS(L.Path.SVG_NS,"path"),d=this._clipPathRectangles[r].getPathString();u.setAttribute("d",d),o.appendChild(u),s.appendChild(o)}this._recurseLayerUntilPath(function(e){e._container.setAttribute("clip-path","url(#"+r+")")},e)}},addTileData:function(e,t){var a,i,s,r=L.Util.isArray(e)?e:e.features;if(r){for(a=0,i=r.length;i>a;a++)s=r[a],(s.geometries||s.geometry||s.features||s.coordinates)&&this.addTileData(r[a],t);return this}var o=this.geojsonLayer.options;if(!o.filter||o.filter(e)){var n=this.geojsonLayer,l=null;if(this.options.unique&&"function"==typeof this.options.unique){var h=this.options.unique(e);h in this._keyLayers&&"GeometryCollection"!==e.geometry.type||(e.geometry={type:"GeometryCollection",geometries:[e.geometry]});try{l=L.GeoJSON.geometryToLayer(e,o.pointToLayer,o.coordsToLatLng)}catch(p){return this}l.feature=L.GeoJSON.asFeature(e),h in this._keyLayers?(n=this._keyLayers[h],n.feature.geometry.geometries.push(e.geometry)):this._keyLayers[h]=l}else{try{l=L.GeoJSON.geometryToLayer(e,o.pointToLayer,o.coordsToLatLng)}catch(p){return this}l.feature=L.GeoJSON.asFeature(e)}return l.defaultOptions=l.options,this.geojsonLayer.resetStyle(l),o.onEachFeature&&o.onEachFeature(e,l),n.addLayer(l),this.options.clipTiles&&this._clipLayerToTileBoundary(l,t),this}},_tileLoaded:function(e,t){return L.TileLayer.Ajax.prototype._tileLoaded.apply(this,arguments),null===e.datum?null:void this.addTileData(e.datum,t)}})}).call(this,window,document);
//# sourceMappingURL=./TileLayer.GeoJSON.min.js.map